---
import { languages, type Lang, getLocalizedPath, getPathWithoutLang } from '../i18n/config';

interface Props {
  lang: Lang;
  translationUrls?: Record<Lang, string>;
}

const { lang, translationUrls } = Astro.props;
const currentPath = Astro.url.pathname;
const pathWithoutLang = getPathWithoutLang(currentPath);
---

<div class="language-switcher flex items-center gap-1">
  {Object.entries(languages).map(([code, name]) => {
    const isActive = code === lang;
    // Use translation URL if available, otherwise fall back to default path conversion
    const href = translationUrls?.[code as Lang] || getLocalizedPath(pathWithoutLang, code as Lang);

    return (
      <a
        href={href}
        class:list={[
          'px-2 py-1 text-xs font-medium rounded transition-colors no-underline',
          isActive
            ? 'bg-[var(--color-primary)] text-white'
            : 'text-[var(--color-text-light)] hover:text-[var(--color-text)] hover:bg-[var(--color-bg-alt)]'
        ]}
        aria-current={isActive ? 'page' : undefined}
      >
        {code.toUpperCase()}
      </a>
    );
  })}
</div>
